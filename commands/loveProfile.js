const Discord = require('discord.js')
const util = require('util')
const utl = require('../utility')
/**
 *  @param {Array<string>} args Command argument
 *  @param {Discord.Message} msg Discord message object
 * @param {Discord.Client} client Discord client object
 * @description Usage: .loveProfile
 */
module.exports = (args, msg, client) => {
    const rClient = require('redis').createClient(process.env.RURL)
    const get = util.promisify(rClient.get).bind(rClient)

    get(msg.author.id)
        .then(res => {
            if(res) {
                var userData = JSON.parse(res)
                if(!userData.loveroom) {
                    utl.embed(msg, '–£ –í–∞—Å –Ω–µ—Ç –ø–∞—Ä—ã!')
                    rClient.quit()
                    return
                }

                var date = new Date(userData.loveroom.creationDate)
                var embed = utl.embed.build(msg, 't')
                    .setDescription(`\`\`\`„Ç´„ÉÉ„Éó„É´ –ü—Ä–æ—Ñ–∏–ª—å –ø–∞—Ä—ã\`\`\`\n\`üíû\` **–ü–∞—Ä—Ç–Ω—ë—Ä:**\n<@${userData.loveroom.partner}>\n\`üìÖ\` **–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–∞—Ä—ã:**\n${date.toLocaleDateString('ru-RU')}`)
                    .setImage("https://media.discordapp.net/attachments/736038639791767594/743986900179615763/unknown.png")
                msg.channel.send(embed)
                rClient.quit()
            } else {
                utl.embed(msg, '–£ –í–∞—Å –Ω–µ—Ç –ø–∞—Ä—ã!')
                rClient.quit()
            }
        })
}